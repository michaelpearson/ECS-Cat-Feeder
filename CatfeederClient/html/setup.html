<html>
  <head>
    <title>ECS Cat feeder</title>
    <script src="scripts.js"></script>
    <script>
      var MINI = require('minified'), $ = MINI.$, $$ = MINI.$$, EE = MINI.EE, HTML = MINI.HTML;
      window.onload = function () {
        $('input, select').set('disabled', true);
        $.request('get', '/scan').then(function (response) {
          var wifiList = $.parseJSON(response);
          for(var a = 0;a < wifiList.length;a++) {
            if([4, 7].indexOf(wifiList[a].encryption) >= 0) {
              $('#wifi_list').add(HTML('<option value="' + wifiList[a].network + '">' + wifiList[a].network + '</option>'));
            }
            $('input, select').set('disabled', false);
          }
        }).error(function () {
          alert("There was an error getting a list of networks");
        });
       };
    </script>
  </head>
  <body>
    <h1>Setup</h1>
    <form action="/save" method="post">
      <div>
        <label for="wifi_list">Wireless network:</label>
        <select id="wifi_list" name="ssid"></select>
      </div>
      <div>
        <label for="password">Network password:</label>
        <input type="password" name="password" id="password" />
      </div>
      <div>
        <input type="submit" value="Save Network" name="save" />
      </div>
    </form>
  </body>
</html>
